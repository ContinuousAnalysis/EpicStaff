<!-- Use the parent's expand signal to control visibility -->
<div class="node-details" *ngIf="parentExpanded()">
  <!-- Instructions Section -->
  <div class="detail-block">
    <div class="detail-header">
      <span class="detail-label">Instructions</span>
    </div>
    <div class="detail-content">
      <p class="detail-text">
        {{
          isInstructionsExpanded()
            ? node.data.instructions
            : (node.data.instructions | slice : 0 : 120)
        }}
        <span
          *ngIf="
            !isInstructionsExpanded() && node.data.instructions.length > 120
          "
        >
          ...
        </span>
      </p>
    </div>
    <!-- Toggle link (only shows if text length is more than 120 characters) -->
    <div
      class="toggle-link"
      *ngIf="node.data.instructions.length > 120"
      (click)="toggleInstructions($event)"
    >
      <span
        *ngIf="!isInstructionsExpanded()"
        (mousedown)="$event.stopPropagation()"
        (mouseup)="$event.stopPropagation()"
      >
        Show More
      </span>
      <span
        *ngIf="isInstructionsExpanded()"
        (mousedown)="$event.stopPropagation()"
        (mouseup)="$event.stopPropagation()"
      >
        Show Less
      </span>
    </div>
  </div>

  <!-- Expected Output Section -->
  <div class="detail-block">
    <div class="detail-header">
      <span class="detail-label">Expected Output</span>
    </div>
    <div class="detail-content">
      <p class="detail-text">
        {{
          isExpectedOutputExpanded()
            ? node.data.expected_output
            : (node.data.expected_output | slice : 0 : 120)
        }}
        <span
          *ngIf="
            !isExpectedOutputExpanded() &&
            node.data.expected_output.length > 120
          "
        >
          ...
        </span>
      </p>
    </div>
    <!-- Toggle link (only shows if text length is more than 120 characters) -->
    <div
      class="toggle-link"
      *ngIf="node.data.expected_output.length > 120"
      (click)="toggleExpectedOutput($event)"
    >
      <span
        *ngIf="!isExpectedOutputExpanded()"
        (mousedown)="$event.stopPropagation()"
        (mouseup)="$event.stopPropagation()"
      >
        Show More
      </span>
      <span
        *ngIf="isExpectedOutputExpanded()"
        (mousedown)="$event.stopPropagation()"
        (mouseup)="$event.stopPropagation()"
      >
        Show Less
      </span>
    </div>
  </div>
</div>
