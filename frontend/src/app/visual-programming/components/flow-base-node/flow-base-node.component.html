<!-- Node name wrapper -->
<div class="node-name-wrapper">
  <div class="node-name-label" *ngIf="!startNode">
    {{ node.node_name || "Unnamed Node" }}
  </div>
</div>

<!-- Control buttons positioned above the node -->
<div class="actions" (mousedown)="$event.stopPropagation()">
  <!-- Ungroup Icon -->
  <div
    *ngIf="node.parentId"
    class="action-button ungroup-button"
    title="Remove from group"
    (click)="onUngroupClick($event)"
  >
    <i class="ti ti-lock-off"></i>
  </div>
</div>

<!-- Ports -->
@for (port of this.node.ports; track port.id) {
<div
  class="port-wrapper port-index-{{ $index }} port-position-{{ port.position }}"
>
  <div
    class="port-circle"
    fNodeInput
    fNodeOutput
    [fInputMultiple]="port.multiple"
    [fOutputMultiple]="port.multiple"
    [fInputId]="port.id"
    [fOutputId]="port.id"
    [isSelfConnectable]="false"
    [fInputConnectableSide]="port.position"
    [fOutputConnectableSide]="port.position"
    [fCanBeConnectedInputs]="portConnections()[port.id]"
    [ngStyle]="{
      'border-color':
        port.port_type === 'output' ? port.color : 'hsl(0, 0%, 15%)',
      'background-color':
        port.port_type === 'input' ? port.color : 'hsl(0, 0%, 15%)'
    }"
  >
    <i
      class="fa-solid fa-plus plus-icon"
      [ngStyle]="{
        color: port.port_type === 'input' ? 'hsl(0, 0%, 15%)' : port.color
      }"
    ></i>
  </div>
  <span class="port-label">{{ port.label }}</span>
</div>
} @if (!edgeNode ) {

<div class="interactive-node-body" clickOrDrag (actualClick)="onEditClick()">
  <!-- Header Section -->
  <div class="header">
    <div class="icon-wrapper">
      <i [class]="node.icon" [style.color]="node.color"></i>
    </div>
    <div class="title">
      {{ getNodeTitle() }}
    </div>
  </div>

  <agent-node
    *ngIf="agentNode"
    [node]="agentNode"
    [parentExpanded]="isExpanded"
  ></agent-node>

  <task-node
    *ngIf="taskNode"
    [node]="taskNode"
    [parentExpanded]="isExpanded"
  ></task-node>
</div>
} @else if (edgeNode) {
<app-conditional-edge-node
  clickOrDrag
  (actualClick)="onEditClick()"
></app-conditional-edge-node>
} @if (node.type === NodeType.TABLE) {
<app-decision-table-node [node]="tableNode"></app-decision-table-node>
}

<!-- Add resize handles only for table nodes -->
@if(node.type === NodeType.TABLE) {
<!-- <app-resize-handle
  [handleType]="eResizeHandleType.RIGHT_BOTTOM"
></app-resize-handle>
<app-resize-handle
  [handleType]="eResizeHandleType.LEFT_BOTTOM"
></app-resize-handle>
<app-resize-handle
  [handleType]="eResizeHandleType.LEFT_TOP"
></app-resize-handle>
<app-resize-handle
  [handleType]="eResizeHandleType.RIGHT_TOP"
></app-resize-handle> -->
<!-- <app-resize-handle [handleType]="eResizeHandleType.RIGHT"></app-resize-handle>
<app-resize-handle [handleType]="eResizeHandleType.LEFT"></app-resize-handle> -->
}
