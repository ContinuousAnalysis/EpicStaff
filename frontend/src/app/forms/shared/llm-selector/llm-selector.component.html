<div class="llm-selector-container">
  <div class="selector-field" (click)="toggleDropdown($event)">
    <div class="selected-value">
      <ng-container *ngIf="selectedValue !== null; else placeholderTemplate">
        {{ getSelectedConfigName() }}
      </ng-container>
      <ng-template #placeholderTemplate>
        <span class="placeholder">{{ placeholder }}</span>
      </ng-template>
    </div>
    <div class="dropdown-arrow">
      <i class="ti ti-chevron-{{ isDropdownOpen ? 'up' : 'down' }}"></i>
    </div>
  </div>

  <!-- Dropdown Panel -->
  <div class="dropdown-panel" *ngIf="isDropdownOpen" @fadeInOut>
    <div class="selector-toolbar">
      <div class="search-container">
        <i class="ti ti-search search-icon"></i>
        <input
          type="text"
          [formControl]="searchControl"
          placeholder="Search models..."
          class="search-input"
          (click)="$event.stopPropagation()"
        />
      </div>

      <div class="filter-actions">
        <button
          type="button"
          class="filter-button"
          matTooltip="Filter options"
          (click)="$event.stopPropagation()"
        >
          <i class="ti ti-filter"></i>
        </button>

        <button
          type="button"
          class="filter-button"
          matTooltip="Show favorites"
          [class.active]="showingFavoritesOnly"
          (click)="showFavoritesOnly(); $event.stopPropagation()"
        >
          <i class="ti ti-star"></i>
        </button>
      </div>
    </div>

    <div class="llm-list">
      <!-- No Configurations Message -->
      <ng-container *ngIf="llmConfigs.length === 0">
        <div class="no-configurations">
          <div class="no-configurations-message">
            No LLM configurations available
          </div>
          <button
            type="button"
            class="create-llm-button"
            (click)="onCreateLLMConfig()"
          >
            <i class="ti ti-plus"></i>
            Create LLM Configuration
          </button>
        </div>
      </ng-container>

      <!-- Existing Configurations List -->
      <ng-container *ngIf="llmConfigs.length > 0">
        <div *ngIf="filteredConfigs.length === 0" class="no-results">
          No models match your search criteria
        </div>
        <div
          *ngFor="let config of filteredConfigs"
          class="llm-item"
          [class.selected]="selectedValue === config.id"
          (click)="onSelectionChange(config.id); $event.stopPropagation()"
        >
          <div class="llm-item-content">
            <div class="llm-model-name">
              {{ config.modelDetails?.name || "Unknown Model" }}
            </div>
            <div class="llm-config-name">{{ config.custom_name }}</div>
          </div>

          <button
            type="button"
            class="favorite-button"
            [class.favorited]="isFavorite(config.id)"
            (click)="toggleFavorite($event, config.id)"
            matTooltip="{{
              isFavorite(config.id)
                ? 'Remove from favorites'
                : 'Add to favorites'
            }}"
          >
            <i
              class="ti ti-{{ isFavorite(config.id) ? 'star-filled' : 'star' }}"
            ></i>
          </button>
        </div>
      </ng-container>
    </div>
  </div>
</div>
