<div class="dialog">
    <!-- Header -->
    <div class="header">
        <div class="header-title">
            <i class="pi pi-tags"></i>
            <h2>Tags</h2>
        </div>
        <p-button
            icon="pi pi-times"
            severity="secondary"
            [text]="true"
            (onClick)="cancel()"
            class="close-btn"
        ></p-button>
    </div>

    <!-- Search -->
    <div class="search">
        <p-iconField iconPosition="left">
            <p-inputIcon styleClass="pi pi-search"></p-inputIcon>
            <input
                type="text"
                pInputText
                placeholder="Search or create tags..."
                [value]="searchTerm()"
                (input)="onSearchChange($event)"
            />
        </p-iconField>
    </div>

    <!-- Tags List -->
    <div class="tags-container">
        <!-- Create New Tag (if search doesn't match existing) -->
        <p-button
            *ngIf="canCreateNewTag()"
            [label]="'Create &quot;' + searchTerm() + '&quot;'"
            severity="primary"
            class="create-tag-btn"
            (onClick)="createTagFromSearch()"
        ></p-button>

        <!-- Existing Tags -->
        <p-button
            *ngFor="let tag of filteredTags()"
            [label]="tag.name"
            [severity]="isTagSelected(tag) ? 'primary' : 'secondary'"
            [outlined]="!isTagSelected(tag)"
            [icon]="isTagSelected(tag) ? 'pi pi-check' : 'pi pi-plus'"
            iconPos="right"
            class="tag-btn"
            (onClick)="toggleTag(tag)"
        ></p-button>

        <!-- Empty State -->
        <div
            class="empty"
            *ngIf="filteredTags().length === 0 && !canCreateNewTag()"
        >
            No tags found
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p-button
            label="Cancel"
            severity="secondary"
            [outlined]="true"
            (onClick)="cancel()"
        ></p-button>
        <p-button
            [label]="'Save (' + selectedTagIds().size + ')'"
            severity="primary"
            (onClick)="save()"
        ></p-button>
    </div>
</div>
