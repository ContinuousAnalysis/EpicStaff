<div class="dialog-container">
  <!-- Header Section -->
  <div class="header">
    <h2 class="dialog-title">
      Advanced Settings for {{ agentData.agentRole }}
    </h2>
    <button class="close-button" (click)="dialogRef.close()">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
        <line
          x1="18"
          y1="6"
          x2="6"
          y2="18"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
        />
        <line
          x1="6"
          y1="6"
          x2="18"
          y2="18"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
        />
      </svg>
    </button>
  </div>
  <!-- Scrollable Content -->
  <div class="scrollable-content">
    <!-- Agent Creativity Section (Top) -->
    <div class="form-section">
      <!-- Temperature using FormSliderComponent -->
      <div class="form-group">
        <app-form-slider
          [value]="temperatureValue"
          label="Agent Creativity Level:"
          (valueChange)="onSliderInput($event)"
        ></app-form-slider>
      </div>

      <div class="form-group">
        <!-- Replaced select with custom LLM selector component -->
        <app-llm-selector
          [label]="'Function Calling LLM:'"
          [llmConfigs]="combinedLLMs"
          [loading]="isLoadingLLMs"
          (llmChange)="onLlmChange($event)"
          [selectedLlmId]="selectedLlmId"
        ></app-llm-selector>
      </div>
    </div>

    <!-- Knowledge Source Section -->
    <div class="form-section">
      <h3 class="section-title">Knowledge Source</h3>

      <!-- Knowledge source selector component -->
      <app-knowledge-selector
        [label]="'Select Knowledge Source:'"
        [collections]="allKnowledgeSources"
        [selectedCollectionId]="agentData.knowledge_collection || null"
        [loading]="isLoadingKnowledgeSources"
        (collectionChange)="onKnowledgeSourceChange($event)"
      ></app-knowledge-selector>
    </div>

    <!-- Execution Settings -->
    <div class="form-section">
      <h3 class="section-title">Execution Settings</h3>

      <div class="form-group">
        <label for="max-iter">Maximum Iterations:</label>
        <input
          id="max-iter"
          [(ngModel)]="agentData.max_iter"
          type="number"
          min="1"
          placeholder="Enter maximum iterations"
        />
      </div>

      <div class="form-group">
        <label for="max-rpm">Maximum Requests Per Minute:</label>
        <input
          id="max-rpm"
          [(ngModel)]="agentData.max_rpm"
          type="number"
          min="0"
          placeholder="Enter maximum RPM"
        />
      </div>

      <div class="form-group">
        <label for="max-exec-time">Maximum Execution Time (seconds):</label>
        <input
          id="max-exec-time"
          [(ngModel)]="agentData.max_execution_time"
          type="number"
          min="0"
          placeholder="Enter maximum execution time"
        />
      </div>

      <div class="form-group">
        <label for="max-retry">Maximum Retry Limit:</label>
        <input
          id="max-retry"
          [(ngModel)]="agentData.max_retry_limit"
          type="number"
          min="0"
          placeholder="Enter maximum retry limit"
        />
      </div>
    </div>

    <!-- Advanced Options -->
    <div class="form-section">
      <h3 class="section-title">Advanced Options</h3>

      <div class="form-group checkbox-group">
        <label for="cache">Enable Response Caching:</label>
        <input id="cache" [(ngModel)]="agentData.cache" type="checkbox" />
      </div>

      <div class="form-group checkbox-group">
        <label for="code-execution">Allow Code Execution:</label>
        <input
          id="code-execution"
          [(ngModel)]="agentData.allow_code_execution"
          type="checkbox"
        />
      </div>

      <div class="form-group checkbox-group">
        <label for="respect-context">Respect Context Window:</label>
        <input
          id="respect-context"
          [(ngModel)]="agentData.respect_context_window"
          type="checkbox"
        />
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="actions">
    <button (click)="dialogRef.close()">Cancel</button>
    <button (click)="save()">Save Changes</button>
  </div>
</div>
