<!-- Editor Header -->
<div *ngIf="showHeader" class="editor-header">
  <div class="left-section">
    <span class="editor-title">
      <i class="ti ti-brackets json-icon"></i>
      {{ title }}
    </span>
    <span class="validation-message" *ngIf="!jsonIsValid">
      Invalid JSON format
    </span>
  </div>
    <div class="right-section">
      @if (collapsible) {
        <app-icon
          class="action-icon"
          [icon]="collapsed ? 'ui/preview' : 'ui/preview-hidden'"
          size="1rem"
          (click)="onToggle()"
        />
      }
      @if (allowCopy) {
        <app-icon
          class="action-icon"
          [icon]="'ui/fold'"
          size="1rem"
          (click)="onCopy()"
        />
      }
    </div>
</div>

<!-- Editor Container -->
<div
  class="editor-container"
  [class.collapsed]="collapsible && collapsed"
  #editorContainer
>
  @if (!collapsible || !collapsed) {
    <ngx-monaco-editor
      [options]="editorOptions"
      [(ngModel)]="jsonData"
      (ngModelChange)="onJsonChange($event)"
      (onInit)="onEditorInit($event)"
      class="monaco-editor"
      [style.height]="fullHeight ? '100%' : editorHeight + 'px'"
    ></ngx-monaco-editor>
  }

  <!-- Loading Overlay -->
  <div class="editor-loading-overlay" *ngIf="!editorLoaded">
    <div class="spinner"></div>
    <span>Loading editor...</span>
  </div>
</div>

<!-- Resize Handle with the directive -->
<div
  class="editor-resize-handle"
  appResizable
  (heightChange)="onResize($event)"
  *ngIf="!fullHeight"
>
  <div class="little-handle"></div>
</div>
